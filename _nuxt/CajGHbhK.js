var It=Object.defineProperty;var kt=(o,t,e)=>t in o?It(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var L=(o,t,e)=>kt(o,typeof t!="symbol"?t+"":t,e);import{l as F,a8 as I,aJ as Mt,aK as Ct,d as _t,aL as rt,v as U,p as k,x as C,C as P,P as D,j as S,Q as T,$ as Ft,_ as pt,m as Ot,aM as q,X as Tt,aN as Vt,r as at,w as Q,E as Lt,aO as Et,aj as Bt,aH as Dt,n as E,V as O,aw as ct,ax as K,a1 as At,ah as $t,Z as jt,aP as ut,a0 as Rt,aQ as Pt,T as dt,F as Nt,y as Wt,z as Ut}from"./CuGlreuw.js";import Jt from"./BqefiKI3.js";import qt from"./mRpwc5bg.js";import{u as Qt,a as Kt}from"./DC2PMduG.js";import{s as Ht}from"./wSbNHcIL.js";import"./3l7zLyuf.js";const Zt=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Gt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Xt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",B=[];class Yt{constructor(){L(this,"_data",new j);L(this,"_hash",new j([...Zt]));L(this,"_nDataBytes",0);L(this,"_minBufferSize",0)}finalize(t){t&&this._append(t);const e=this._nDataBytes*8,s=this._data.sigBytes*8;return this._data.words[s>>>5]|=128<<24-s%32,this._data.words[(s+64>>>9<<4)+14]=Math.floor(e/4294967296),this._data.words[(s+64>>>9<<4)+15]=e,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(t,e){const s=this._hash.words;let n=s[0],i=s[1],r=s[2],a=s[3],c=s[4],d=s[5],l=s[6],m=s[7];for(let h=0;h<64;h++){if(h<16)B[h]=t[e+h]|0;else{const v=B[h-15],M=(v<<25|v>>>7)^(v<<14|v>>>18)^v>>>3,p=B[h-2],b=(p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10;B[h]=M+B[h-7]+b+B[h-16]}const g=c&d^~c&l,f=n&i^n&r^i&r,u=(n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22),_=(c<<26|c>>>6)^(c<<21|c>>>11)^(c<<7|c>>>25),y=m+_+g+Gt[h]+B[h],w=u+f;m=l,l=d,d=c,c=a+y|0,a=r,r=i,i=n,n=y+w|0}s[0]=s[0]+n|0,s[1]=s[1]+i|0,s[2]=s[2]+r|0,s[3]=s[3]+a|0,s[4]=s[4]+c|0,s[5]=s[5]+d|0,s[6]=s[6]+l|0,s[7]=s[7]+m|0}_append(t){typeof t=="string"&&(t=j.fromUtf8(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_process(t){let e,s=this._data.sigBytes/64;t?s=Math.ceil(s):s=Math.max((s|0)-this._minBufferSize,0);const n=s*16,i=Math.min(n*4,this._data.sigBytes);if(n){for(let r=0;r<n;r+=16)this._doProcessBlock(this._data.words,r);e=this._data.words.splice(0,n),this._data.sigBytes-=i}return new j(e,i)}}class j{constructor(t,e){L(this,"words");L(this,"sigBytes");t=this.words=t||[],this.sigBytes=e===void 0?t.length*4:e}static fromUtf8(t){const e=unescape(encodeURIComponent(t)),s=e.length,n=[];for(let i=0;i<s;i++)n[i>>>2]|=(e.charCodeAt(i)&255)<<24-i%4*8;return new j(n,s)}toBase64(){const t=[];for(let e=0;e<this.sigBytes;e+=3){const s=this.words[e>>>2]>>>24-e%4*8&255,n=this.words[e+1>>>2]>>>24-(e+1)%4*8&255,i=this.words[e+2>>>2]>>>24-(e+2)%4*8&255,r=s<<16|n<<8|i;for(let a=0;a<4&&e*8+a*6<this.sigBytes*8;a++)t.push(Xt.charAt(r>>>6*(3-a)&63))}return t.join("")}concat(t){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let e=0;e<t.sigBytes;e++){const s=t.words[e>>>2]>>>24-e%4*8&255;this.words[this.sigBytes+e>>>2]|=s<<24-(this.sigBytes+e)%4*8}else for(let e=0;e<t.sigBytes;e+=4)this.words[this.sigBytes+e>>>2]=t.words[e>>>2];this.sigBytes+=t.sigBytes}}function te(o){return new Yt().finalize(o).toBase64()}function ee(o){return te(Ht(o))}function ht(o,t,e){const[s={},n]=typeof t=="string"?[{},t]:[t,e],i=F(()=>I(o)),r=s.key||ee([n,typeof i.value=="string"?i.value:"",...se(s)]);if(!r||typeof r!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+r);if(!o)throw new Error("[nuxt] [useFetch] request is missing.");const a=r===n?"$f"+r:r;if(!s.baseURL&&typeof i.value=="string"&&i.value[0]==="/"&&i.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:c,lazy:d,default:l,transform:m,pick:h,watch:g,immediate:f,getCachedData:u,deep:_,dedupe:y,...w}=s,v=Mt({...Ct,...w,cache:typeof s.cache=="boolean"?void 0:s.cache}),M={server:c,lazy:d,default:l,transform:m,pick:h,immediate:f,getCachedData:u,deep:_,dedupe:y,watch:g===!1?[]:[v,i,...g||[]]};let p;return Qt(a,()=>{var ot;(ot=p==null?void 0:p.abort)==null||ot.call(p,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),p=typeof AbortController<"u"?new AbortController:{};const z=I(s.timeout);let R;return z&&(R=setTimeout(()=>p.abort(new DOMException("Request aborted due to timeout.","AbortError")),z),p.signal.onabort=()=>clearTimeout(R)),(s.$fetch||globalThis.$fetch)(i.value,{signal:p.signal,...v}).finally(()=>{clearTimeout(R)})},M)}function se(o){var e;const t=[((e=I(o.method))==null?void 0:e.toUpperCase())||"GET",I(o.baseURL)];for(const s of[o.params||o.query]){const n=I(s);if(!n)continue;const i={};for(const[r,a]of Object.entries(n))i[I(r)]=I(a);t.push(i)}return t}const ne=["innerHTML"],ie=["innerHTML"],oe=_t({__name:"SearchItem",props:{title:{},content:{},titles:{},id:{},terms:{},queryTerms:{},score:{},match:{}},setup(o){const t=o,e=F(()=>[...t.titles??[],t.title].join(" > ")),s=F(()=>{var a;return(a=t.titles)==null?void 0:a.length}),n=F(()=>{var a;return((a=t.queryTerms)==null?void 0:a[0])??""}),i=F(()=>rt(e.value,n.value)),r=F(()=>rt(t.content??"",n.value));return(a,c)=>{const d=Jt,l=Ft;return k(),U(l,{to:a.id,class:"search-item"},{default:C(()=>[P("h2",null,[S(s)?D("",!0):(k(),U(d,{key:0,round:""},{default:C(()=>c[0]||(c[0]=[T(" 文章 ")])),_:1})),P("span",{innerHTML:S(i)},null,8,ne)]),P("p",{class:"content",innerHTML:S(r)},null,8,ie)]),_:1},8,["to"])}}}),re=Object.assign(pt(oe,[["__scopeId","data-v-3622524a"]]),{__name:"ZSearchItem"}),ae="ENTRIES",wt="KEYS",yt="VALUES",x="";class H{constructor(t,e){const s=t._tree,n=Array.from(s.keys());this.set=t,this._type=e,this._path=n.length>0?[{node:s,keys:n}]:[]}next(){const t=this.dive();return this.backtrack(),t}dive(){if(this._path.length===0)return{done:!0,value:void 0};const{node:t,keys:e}=$(this._path);if($(e)===x)return{done:!1,value:this.result()};const s=t.get($(e));return this._path.push({node:s,keys:Array.from(s.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;const t=$(this._path).keys;t.pop(),!(t.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:t})=>$(t)).filter(t=>t!==x).join("")}value(){return $(this._path).node.get(x)}result(){switch(this._type){case yt:return this.value();case wt:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}}const $=o=>o[o.length-1],ce=(o,t,e)=>{const s=new Map;if(t===void 0)return s;const n=t.length+1,i=n+e,r=new Uint8Array(i*n).fill(e+1);for(let a=0;a<n;++a)r[a]=a;for(let a=1;a<i;++a)r[a*n]=a;return vt(o,t,e,s,r,1,n,""),s},vt=(o,t,e,s,n,i,r,a)=>{const c=i*r;t:for(const d of o.keys())if(d===x){const l=n[c-1];l<=e&&s.set(a,[o.get(d),l])}else{let l=i;for(let m=0;m<d.length;++m,++l){const h=d[m],g=r*l,f=g-r;let u=n[g];const _=Math.max(0,l-e-1),y=Math.min(r-1,l+e);for(let w=_;w<y;++w){const v=h!==t[w],M=n[f+w]+ +v,p=n[f+w+1]+1,b=n[g+w]+1,z=n[g+w+1]=Math.min(M,p,b);z<u&&(u=z)}if(u>e)continue t}vt(o.get(d),t,e,s,n,l,r,a+d)}};class V{constructor(t=new Map,e=""){this._size=void 0,this._tree=t,this._prefix=e}atPrefix(t){if(!t.startsWith(this._prefix))throw new Error("Mismatched prefix");const[e,s]=J(this._tree,t.slice(this._prefix.length));if(e===void 0){const[n,i]=nt(s);for(const r of n.keys())if(r!==x&&r.startsWith(i)){const a=new Map;return a.set(r.slice(i.length),n.get(r)),new V(a,t)}}return new V(e,t)}clear(){this._size=void 0,this._tree.clear()}delete(t){return this._size=void 0,ue(this._tree,t)}entries(){return new H(this,ae)}forEach(t){for(const[e,s]of this)t(e,s,this)}fuzzyGet(t,e){return ce(this._tree,t,e)}get(t){const e=tt(this._tree,t);return e!==void 0?e.get(x):void 0}has(t){const e=tt(this._tree,t);return e!==void 0&&e.has(x)}keys(){return new H(this,wt)}set(t,e){if(typeof t!="string")throw new Error("key must be a string");return this._size=void 0,Z(this._tree,t).set(x,e),this}get size(){if(this._size)return this._size;this._size=0;const t=this.entries();for(;!t.next().done;)this._size+=1;return this._size}update(t,e){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;const s=Z(this._tree,t);return s.set(x,e(s.get(x))),this}fetch(t,e){if(typeof t!="string")throw new Error("key must be a string");this._size=void 0;const s=Z(this._tree,t);let n=s.get(x);return n===void 0&&s.set(x,n=e()),n}values(){return new H(this,yt)}[Symbol.iterator](){return this.entries()}static from(t){const e=new V;for(const[s,n]of t)e.set(s,n);return e}static fromObject(t){return V.from(Object.entries(t))}}const J=(o,t,e=[])=>{if(t.length===0||o==null)return[o,e];for(const s of o.keys())if(s!==x&&t.startsWith(s))return e.push([o,s]),J(o.get(s),t.slice(s.length),e);return e.push([o,t]),J(void 0,"",e)},tt=(o,t)=>{if(t.length===0||o==null)return o;for(const e of o.keys())if(e!==x&&t.startsWith(e))return tt(o.get(e),t.slice(e.length))},Z=(o,t)=>{const e=t.length;t:for(let s=0;o&&s<e;){for(const i of o.keys())if(i!==x&&t[s]===i[0]){const r=Math.min(e-s,i.length);let a=1;for(;a<r&&t[s+a]===i[a];)++a;const c=o.get(i);if(a===i.length)o=c;else{const d=new Map;d.set(i.slice(a),c),o.set(t.slice(s,s+a),d),o.delete(i),o=d}s+=a;continue t}const n=new Map;return o.set(t.slice(s),n),n}return o},ue=(o,t)=>{const[e,s]=J(o,t);if(e!==void 0){if(e.delete(x),e.size===0)St(s);else if(e.size===1){const[n,i]=e.entries().next().value;bt(s,n,i)}}},St=o=>{if(o.length===0)return;const[t,e]=nt(o);if(t.delete(e),t.size===0)St(o.slice(0,-1));else if(t.size===1){const[s,n]=t.entries().next().value;s!==x&&bt(o.slice(0,-1),s,n)}},bt=(o,t,e)=>{if(o.length===0)return;const[s,n]=nt(o);s.set(n+t,e),s.delete(n)},nt=o=>o[o.length-1],it="or",xt="and",de="and_not";class A{constructor(t){if((t==null?void 0:t.fields)==null)throw new Error('MiniSearch: option "fields" must be provided');const e=t.autoVacuum==null||t.autoVacuum===!0?Y:t.autoVacuum;this._options={...X,...t,autoVacuum:e,searchOptions:{...lt,...t.searchOptions||{}},autoSuggestOptions:{...ge,...t.autoSuggestOptions||{}}},this._index=new V,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=st,this.addFields(this._options.fields)}add(t){const{extractField:e,tokenize:s,processTerm:n,fields:i,idField:r}=this._options,a=e(t,r);if(a==null)throw new Error(`MiniSearch: document does not have ID field "${r}"`);if(this._idToShortId.has(a))throw new Error(`MiniSearch: duplicate ID ${a}`);const c=this.addDocumentId(a);this.saveStoredFields(c,t);for(const d of i){const l=e(t,d);if(l==null)continue;const m=s(l.toString(),d),h=this._fieldIds[d],g=new Set(m).size;this.addFieldLength(c,h,this._documentCount-1,g);for(const f of m){const u=n(f,d);if(Array.isArray(u))for(const _ of u)this.addTerm(h,c,_);else u&&this.addTerm(h,c,u)}}}addAll(t){for(const e of t)this.add(e)}addAllAsync(t,e={}){const{chunkSize:s=10}=e,n={chunk:[],promise:Promise.resolve()},{chunk:i,promise:r}=t.reduce(({chunk:a,promise:c},d,l)=>(a.push(d),(l+1)%s===0?{chunk:[],promise:c.then(()=>new Promise(m=>setTimeout(m,0))).then(()=>this.addAll(a))}:{chunk:a,promise:c}),n);return r.then(()=>this.addAll(i))}remove(t){const{tokenize:e,processTerm:s,extractField:n,fields:i,idField:r}=this._options,a=n(t,r);if(a==null)throw new Error(`MiniSearch: document does not have ID field "${r}"`);const c=this._idToShortId.get(a);if(c==null)throw new Error(`MiniSearch: cannot remove document with ID ${a}: it is not in the index`);for(const d of i){const l=n(t,d);if(l==null)continue;const m=e(l.toString(),d),h=this._fieldIds[d],g=new Set(m).size;this.removeFieldLength(c,h,this._documentCount,g);for(const f of m){const u=s(f,d);if(Array.isArray(u))for(const _ of u)this.removeTerm(h,c,_);else u&&this.removeTerm(h,c,u)}}this._storedFields.delete(c),this._documentIds.delete(c),this._idToShortId.delete(a),this._fieldLength.delete(c),this._documentCount-=1}removeAll(t){if(t)for(const e of t)this.remove(e);else{if(arguments.length>0)throw new Error("Expected documents to be present. Omit the argument to remove all documents.");this._index=new V,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}}discard(t){const e=this._idToShortId.get(t);if(e==null)throw new Error(`MiniSearch: cannot discard document with ID ${t}: it is not in the index`);this._idToShortId.delete(t),this._documentIds.delete(e),this._storedFields.delete(e),(this._fieldLength.get(e)||[]).forEach((s,n)=>{this.removeFieldLength(e,n,this._documentCount,s)}),this._fieldLength.delete(e),this._documentCount-=1,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;const{minDirtFactor:t,minDirtCount:e,batchSize:s,batchWait:n}=this._options.autoVacuum;this.conditionalVacuum({batchSize:s,batchWait:n},{minDirtCount:e,minDirtFactor:t})}discardAll(t){const e=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(const s of t)this.discard(s)}finally{this._options.autoVacuum=e}this.maybeAutoVacuum()}replace(t){const{idField:e,extractField:s}=this._options,n=s(t,e);this.discard(n),this.add(t)}vacuum(t={}){return this.conditionalVacuum(t)}conditionalVacuum(t,e){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&e,this._enqueuedVacuum!=null?this._enqueuedVacuum:(this._enqueuedVacuum=this._currentVacuum.then(()=>{const s=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=st,this.performVacuuming(t,s)}),this._enqueuedVacuum)):this.vacuumConditionsMet(e)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(t),this._currentVacuum)}async performVacuuming(t,e){const s=this._dirtCount;if(this.vacuumConditionsMet(e)){const n=t.batchSize||et.batchSize,i=t.batchWait||et.batchWait;let r=1;for(const[a,c]of this._index){for(const[d,l]of c)for(const[m]of l)this._documentIds.has(m)||(l.size<=1?c.delete(d):l.delete(m));this._index.get(a).size===0&&this._index.delete(a),r%n===0&&await new Promise(d=>setTimeout(d,i)),r+=1}this._dirtCount-=s}await null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null}vacuumConditionsMet(t){if(t==null)return!0;let{minDirtCount:e,minDirtFactor:s}=t;return e=e||Y.minDirtCount,s=s||Y.minDirtFactor,this.dirtCount>=e&&this.dirtFactor>=s}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(t){return this._idToShortId.has(t)}getStoredFields(t){const e=this._idToShortId.get(t);if(e!=null)return this._storedFields.get(e)}search(t,e={}){const{searchOptions:s}=this._options,n={...s,...e},i=this.executeQuery(t,e),r=[];for(const[a,{score:c,terms:d,match:l}]of i){const m=d.length||1,h={id:this._documentIds.get(a),score:c*m,terms:Object.keys(l),queryTerms:d,match:l};Object.assign(h,this._storedFields.get(a)),(n.filter==null||n.filter(h))&&r.push(h)}return t===A.wildcard&&n.boostDocument==null||r.sort(mt),r}autoSuggest(t,e={}){e={...this._options.autoSuggestOptions,...e};const s=new Map;for(const{score:i,terms:r}of this.search(t,e)){const a=r.join(" "),c=s.get(a);c!=null?(c.score+=i,c.count+=1):s.set(a,{score:i,terms:r,count:1})}const n=[];for(const[i,{score:r,terms:a,count:c}]of s)n.push({suggestion:i,terms:a,score:r/c});return n.sort(mt),n}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(t,e){if(e==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJS(JSON.parse(t),e)}static async loadJSONAsync(t,e){if(e==null)throw new Error("MiniSearch: loadJSON should be given the same options used when serializing the index");return this.loadJSAsync(JSON.parse(t),e)}static getDefault(t){if(X.hasOwnProperty(t))return G(X,t);throw new Error(`MiniSearch: unknown option "${t}"`)}static loadJS(t,e){const{index:s,documentIds:n,fieldLength:i,storedFields:r,serializationVersion:a}=t,c=this.instantiateMiniSearch(t,e);c._documentIds=N(n),c._fieldLength=N(i),c._storedFields=N(r);for(const[d,l]of c._documentIds)c._idToShortId.set(l,d);for(const[d,l]of s){const m=new Map;for(const h of Object.keys(l)){let g=l[h];a===1&&(g=g.ds),m.set(parseInt(h,10),N(g))}c._index.set(d,m)}return c}static async loadJSAsync(t,e){const{index:s,documentIds:n,fieldLength:i,storedFields:r,serializationVersion:a}=t,c=this.instantiateMiniSearch(t,e);c._documentIds=await W(n),c._fieldLength=await W(i),c._storedFields=await W(r);for(const[l,m]of c._documentIds)c._idToShortId.set(m,l);let d=0;for(const[l,m]of s){const h=new Map;for(const g of Object.keys(m)){let f=m[g];a===1&&(f=f.ds),h.set(parseInt(g,10),await W(f))}++d%1e3===0&&await zt(0),c._index.set(l,h)}return c}static instantiateMiniSearch(t,e){const{documentCount:s,nextId:n,fieldIds:i,averageFieldLength:r,dirtCount:a,serializationVersion:c}=t;if(c!==1&&c!==2)throw new Error("MiniSearch: cannot deserialize an index created with an incompatible version");const d=new A(e);return d._documentCount=s,d._nextId=n,d._idToShortId=new Map,d._fieldIds=i,d._avgFieldLength=r,d._dirtCount=a||0,d._index=new V,d}executeQuery(t,e={}){if(t===A.wildcard)return this.executeWildcardQuery(e);if(typeof t!="string"){const h={...e,...t,queries:void 0},g=t.queries.map(f=>this.executeQuery(f,h));return this.combineResults(g,h.combineWith)}const{tokenize:s,processTerm:n,searchOptions:i}=this._options,r={tokenize:s,processTerm:n,...i,...e},{tokenize:a,processTerm:c}=r,m=a(t).flatMap(h=>c(h)).filter(h=>!!h).map(me(r)).map(h=>this.executeQuerySpec(h,r));return this.combineResults(m,r.combineWith)}executeQuerySpec(t,e){const s={...this._options.searchOptions,...e},n=(s.fields||this._options.fields).reduce((u,_)=>({...u,[_]:G(s.boost,_)||1}),{}),{boostDocument:i,weights:r,maxFuzzy:a,bm25:c}=s,{fuzzy:d,prefix:l}={...lt.weights,...r},m=this._index.get(t.term),h=this.termResults(t.term,t.term,1,t.termBoost,m,n,i,c);let g,f;if(t.prefix&&(g=this._index.atPrefix(t.term)),t.fuzzy){const u=t.fuzzy===!0?.2:t.fuzzy,_=u<1?Math.min(a,Math.round(t.term.length*u)):u;_&&(f=this._index.fuzzyGet(t.term,_))}if(g)for(const[u,_]of g){const y=u.length-t.term.length;if(!y)continue;f==null||f.delete(u);const w=l*u.length/(u.length+.3*y);this.termResults(t.term,u,w,t.termBoost,_,n,i,c,h)}if(f)for(const u of f.keys()){const[_,y]=f.get(u);if(!y)continue;const w=d*u.length/(u.length+y);this.termResults(t.term,u,w,t.termBoost,_,n,i,c,h)}return h}executeWildcardQuery(t){const e=new Map,s={...this._options.searchOptions,...t};for(const[n,i]of this._documentIds){const r=s.boostDocument?s.boostDocument(i,"",this._storedFields.get(n)):1;e.set(n,{score:r,terms:[],match:{}})}return e}combineResults(t,e=it){if(t.length===0)return new Map;const s=e.toLowerCase(),n=he[s];if(!n)throw new Error(`Invalid combination operator: ${e}`);return t.reduce(n)||new Map}toJSON(){const t=[];for(const[e,s]of this._index){const n={};for(const[i,r]of s)n[i]=Object.fromEntries(r);t.push([e,n])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:t,serializationVersion:2}}termResults(t,e,s,n,i,r,a,c,d=new Map){if(i==null)return d;for(const l of Object.keys(r)){const m=r[l],h=this._fieldIds[l],g=i.get(h);if(g==null)continue;let f=g.size;const u=this._avgFieldLength[h];for(const _ of g.keys()){if(!this._documentIds.has(_)){this.removeTerm(h,_,e),f-=1;continue}const y=a?a(this._documentIds.get(_),e,this._storedFields.get(_)):1;if(!y)continue;const w=g.get(_),v=this._fieldLength.get(_)[h],M=fe(w,f,this._documentCount,v,u,c),p=s*n*m*y*M,b=d.get(_);if(b){b.score+=p,_e(b.terms,t);const z=G(b.match,e);z?z.push(l):b.match[e]=[l]}else d.set(_,{score:p,terms:[t],match:{[e]:[l]}})}}return d}addTerm(t,e,s){const n=this._index.fetch(s,gt);let i=n.get(t);if(i==null)i=new Map,i.set(e,1),n.set(t,i);else{const r=i.get(e);i.set(e,(r||0)+1)}}removeTerm(t,e,s){if(!this._index.has(s)){this.warnDocumentChanged(e,t,s);return}const n=this._index.fetch(s,gt),i=n.get(t);i==null||i.get(e)==null?this.warnDocumentChanged(e,t,s):i.get(e)<=1?i.size<=1?n.delete(t):i.delete(e):i.set(e,i.get(e)-1),this._index.get(s).size===0&&this._index.delete(s)}warnDocumentChanged(t,e,s){for(const n of Object.keys(this._fieldIds))if(this._fieldIds[n]===e){this._options.logger("warn",`MiniSearch: document with ID ${this._documentIds.get(t)} has changed before removal: term "${s}" was not present in field "${n}". Removing a document after it has changed can corrupt the index!`,"version_conflict");return}}addDocumentId(t){const e=this._nextId;return this._idToShortId.set(t,e),this._documentIds.set(e,t),this._documentCount+=1,this._nextId+=1,e}addFields(t){for(let e=0;e<t.length;e++)this._fieldIds[t[e]]=e}addFieldLength(t,e,s,n){let i=this._fieldLength.get(t);i==null&&this._fieldLength.set(t,i=[]),i[e]=n;const a=(this._avgFieldLength[e]||0)*s+n;this._avgFieldLength[e]=a/(s+1)}removeFieldLength(t,e,s,n){if(s===1){this._avgFieldLength[e]=0;return}const i=this._avgFieldLength[e]*s-n;this._avgFieldLength[e]=i/(s-1)}saveStoredFields(t,e){const{storeFields:s,extractField:n}=this._options;if(s==null||s.length===0)return;let i=this._storedFields.get(t);i==null&&this._storedFields.set(t,i={});for(const r of s){const a=n(e,r);a!==void 0&&(i[r]=a)}}}A.wildcard=Symbol("*");const G=(o,t)=>Object.prototype.hasOwnProperty.call(o,t)?o[t]:void 0,he={[it]:(o,t)=>{for(const e of t.keys()){const s=o.get(e);if(s==null)o.set(e,t.get(e));else{const{score:n,terms:i,match:r}=t.get(e);s.score=s.score+n,s.match=Object.assign(s.match,r),ft(s.terms,i)}}return o},[xt]:(o,t)=>{const e=new Map;for(const s of t.keys()){const n=o.get(s);if(n==null)continue;const{score:i,terms:r,match:a}=t.get(s);ft(n.terms,r),e.set(s,{score:n.score+i,terms:n.terms,match:Object.assign(n.match,a)})}return e},[de]:(o,t)=>{for(const e of t.keys())o.delete(e);return o}},le={k:1.2,b:.7,d:.5},fe=(o,t,e,s,n,i)=>{const{k:r,b:a,d:c}=i;return Math.log(1+(e-t+.5)/(t+.5))*(c+o*(r+1)/(o+r*(1-a+a*s/n)))},me=o=>(t,e,s)=>{const n=typeof o.fuzzy=="function"?o.fuzzy(t,e,s):o.fuzzy||!1,i=typeof o.prefix=="function"?o.prefix(t,e,s):o.prefix===!0,r=typeof o.boostTerm=="function"?o.boostTerm(t,e,s):1;return{term:t,fuzzy:n,prefix:i,termBoost:r}},X={idField:"id",extractField:(o,t)=>o[t],tokenize:o=>o.split(pe),processTerm:o=>o.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(o,t)=>{typeof(console==null?void 0:console[o])=="function"&&console[o](t)},autoVacuum:!0},lt={combineWith:it,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:le},ge={combineWith:xt,prefix:(o,t,e)=>t===e.length-1},et={batchSize:1e3,batchWait:10},st={minDirtFactor:.1,minDirtCount:20},Y={...et,...st},_e=(o,t)=>{o.includes(t)||o.push(t)},ft=(o,t)=>{for(const e of t)o.includes(e)||o.push(e)},mt=({score:o},{score:t})=>t-o,gt=()=>new Map,N=o=>{const t=new Map;for(const e of Object.keys(o))t.set(parseInt(e,10),o[e]);return t},W=async o=>{const t=new Map;let e=0;for(const s of Object.keys(o))t.set(parseInt(s,10),o[s]),++e%1e3===0&&await zt(0);return t},zt=o=>new Promise(t=>setTimeout(t,o)),pe=/[\n\r\p{Z}\p{P}]+/u,we=async(o,t={})=>{const e=Ot(),{content:s}=e.public,{integrity:n,api:{baseURL:i},search:r}=s,{indexed:a}=r||{},c=`${i}/search${n?"-"+n:""}`;if(a){const{options:m}=r||{},{data:h}=await ht(c,{responseType:"text"},"$C9P97aiw7k");if(!h.value)throw q({statusCode:500,message:"Missing search data"});return ye(o,h,m)}if(!t.miniSearch)throw q({statusCode:500,message:"Missing miniSearch options"});const{data:d}=await ht(c,"$HXJEohvOba");if(!d.value)throw q({statusCode:500,message:"Missing search data"});return ve(o,d,t.miniSearch)},ye=(o,t,e)=>{const s=F(()=>A.loadJSON(I(t),I(e)));return F(()=>s.value.search(I(o)))},ve=function(o,t,e){const s=F(()=>new A(I(e)));return s.value.addAll(I(t)),F(()=>s.value.search(I(o)))},Se={class:"z-search"},be={key:0,id:"z-search"},xe={key:0,class:"no-result"},ze={key:1,ref:"list-result",class:"scrollcheck-y search-result"},Ie=_t({__name:"Search",props:{isOpening:{type:Boolean}},setup(o){const t=o,e=Tt(),s=Vt(),n=at();Q(()=>t.isOpening,async f=>{var u;await Lt(),f&&((u=n.value)==null||u.select())});const{word:i,result:r}=Et(s),a=at(0),c=Bt("list-result"),{data:d,execute:l,status:m}=Kt(i.value,()=>we(i.value),{immediate:!1,transform:f=>f.value});Dt(i,()=>{a.value=0,i.value&&l()},{debounce:300}),Q(()=>d.value,f=>{r.value=f}),Q(a,(f,u)=>{var _,y;(_=r.value)!=null&&_.length&&(f<0||f>=((y=r.value)==null?void 0:y.length))&&(a.value=u)});function h(){var f;((f=c.value)==null?void 0:f.children[a.value]).scrollIntoView({behavior:"smooth",block:"nearest"})}function g(){var u;((u=c.value)==null?void 0:u.children[a.value]).dispatchEvent(new Event("click"))}return(f,u)=>{const _=jt,y=re,w=qt;return k(),E("div",Se,[O(ct,null,{default:C(()=>[f.isOpening?(k(),E("div",{key:0,id:"z-search-bgmask",onClick:u[0]||(u[0]=v=>S(e).toggle("search"))})):D("",!0)]),_:1}),O(ct,{name:"float-in"},{default:C(()=>[f.isOpening?(k(),E("div",be,[P("form",{class:At(["input",{searching:S(m)==="pending"}]),onSubmit:u[5]||(u[5]=K(()=>{},["prevent"]))},[O(_,{name:"ph:magnifying-glass-bold"}),$t(P("input",{ref_key:"searchInput",ref:n,"onUpdate:modelValue":u[1]||(u[1]=v=>Rt(i)?i.value=v:null),class:"search-input",placeholder:"Nhập để tìm kiếm",onKeydown:[u[2]||(u[2]=ut(K(()=>{},["prevent"]),["up"])),u[3]||(u[3]=ut(K(()=>{},["prevent"]),["down"]))]},null,544),[[Pt,S(i)]]),S(i)?(k(),U(_,{key:0,class:"close",name:"ph:x-bold",onClick:u[4]||(u[4]=v=>i.value="")})):D("",!0)],34),O(dt,{name:"expand"},{default:C(()=>{var v,M,p;return[S(i)&&S(m)==="success"&&!((v=S(r))!=null&&v.length)?(k(),E("div",xe," Không có kết quả ")):D("",!0),S(i)&&((M=S(r))!=null&&M.length)?(k(),E("ol",ze,[O(dt,{name:"list"},{default:C(()=>[(k(!0),E(Nt,null,Wt(S(r),(b,z)=>(k(),U(y,Ut({key:b.id,ref_for:!0},b,{class:{active:S(a)===z},onClick:u[6]||(u[6]=R=>S(e).toggle("search")),onMouseover:R=>a.value=z}),null,16,["class","onMouseover"]))),128))]),_:1})],512)):D("",!0),S(i)&&((p=S(r))!=null&&p.length)?(k(),E("div",{key:2,class:"tip",onClick:u[10]||(u[10]=b=>{var z;return(z=S(n))==null?void 0:z.focus()})},[O(w,{code:"arrowup",onPress:u[7]||(u[7]=b=>(a.value--,h()))},{default:C(()=>u[11]||(u[11]=[T(" ↑ ")])),_:1}),u[15]||(u[15]=T()),O(w,{code:"arrowdown",onPress:u[8]||(u[8]=b=>(a.value++,h()))},{default:C(()=>u[12]||(u[12]=[T(" ↓ ")])),_:1}),u[16]||(u[16]=T(" Chuyển đổi  ")),O(w,{code:"enter",onPress:g},{default:C(()=>u[13]||(u[13]=[T(" Enter ")])),_:1}),u[17]||(u[17]=T(" Chọn  ")),O(w,{code:"escape",onPress:u[9]||(u[9]=b=>S(e).toggle("search"))},{default:C(()=>u[14]||(u[14]=[T(" Esc ")])),_:1}),u[18]||(u[18]=T(" Đóng "))])):D("",!0)]}),_:1})])):D("",!0)]),_:1})])}}}),Ee=Object.assign(pt(Ie,[["__scopeId","data-v-f3ba3bd2"]]),{__name:"PopoverSearch"});export{Ee as default};
